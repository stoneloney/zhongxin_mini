(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0cd5":function(n,e,o){"use strict";(function(n,e){var t=o("4ea4");o("b783");t(o("66fd"));var a=t(o("dc95"));n.__webpack_require_UNI_MP_PLUGIN__=o,e(a.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},"1c9a":function(n,e,o){"use strict";o.d(e,"b",(function(){return t})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){}));var t=function(){var n=this.$createElement;this._self._c},a=[]},"7e86":function(n,e,o){"use strict";o.r(e);var t=o("826e"),a=o.n(t);for(var i in t)["default"].indexOf(i)<0&&function(n){o.d(e,n,(function(){return t[n]}))}(i);e["default"]=a.a},"826e":function(n,e,o){"use strict";(function(n,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o("7789"),i=o("2246"),c={components:{WxUserInfoModal:function(){o.e("uni_modules/tuniaoui-wx-user-info/components/tuniaoui-wx-user-info/tuniaoui-wx-user-info").then(function(){return resolve(o("86df"))}.bind(null,o)).catch(o.oe)}},data:function(){return{showAuthorizationModal:!1,userInfo:{},phone:"",hasPhone:!1,hasUserInfo:!1}},created:function(){var e=n.getStorageSync("phone");if(e){this.hasPhone=!0,this.phone=e;var o=n.getStorageSync("userInfo");o&&(this.hasUserInfo=!0,this.userInfo=o)}},methods:{openAuthorizationModal:function(){this.showAuthorizationModal=!0},updatedUserInfoEvent:function(e){this.userInfo=e,console.log(e),n.setStorageSync("userInfo",e),this.login()},getPhoneNumber:function(e){var o=this;(0,a.WeixinPhone)(e.detail.code,(function(e){0===e.code?(o.phone=e.data.phone,o.hasPhone=!0,n.setStorageSync("phone",o.phone)):n.showModal({title:"title",content:"授权失败，请重新授权",showCancel:!1})}))},login:function(){var e=this;n.login({provider:"weixin",onlyAuthorize:!0,success:function(o){"login:ok"==o.errMsg?(console.log(o),(0,a.WeixinCode)(o.code,(function(o){0===o.code?(e.openid=o.data.openid,n.setStorageSync("openid",o.data.openid),n.setStorageSync("token",o.data.salt),t.getUserInfo({success:function(o){if("getUserInfo:ok"==o.errMsg){var t=o.userInfo,a=(t.avatarUrl,t.city),c=t.country,r=t.gender,u=(t.nickName,t.province);(0,i.MemberInfoUpdate)({avatar:e.userInfo.avatar,nickname:e.userInfo.nickname,gender:r,country:c,province:u,city:a,phone:e.phone,openid:e.openid},(function(o){0===o.code?(n.setStorageSync("memberInfo",{avatar:e.userInfo.avatar,nickname:e.userInfo.nickname,gender:r,country:c,province:u,phone:e.phone,city:a}),n.navigateTo({url:"/pages/user/user"})):n.showModal({title:"title",content:"授权失败，请重新授权(1004)",showCancel:!1})}))}else n.showModal({title:"title",content:"您取消了授权登录，请重新授权(1003)",showCancel:!1})},fail:function(e){n.showModal({title:"title",content:"授权失败，请重新授权(1002)",showCancel:!1})}})):n.showModal({title:"title",content:"授权失败，请重新授权(1001)",showCancel:!1})}))):n.showModal({title:"title",content:"您取消了授权登录，请重新授权",showCancel:!1})}})}}};e.default=c}).call(this,o("543d")["default"],o("bc2e")["default"])},a679:function(n,e,o){},ca1f:function(n,e,o){"use strict";var t=o("a679"),a=o.n(t);a.a},dc95:function(n,e,o){"use strict";o.r(e);var t=o("1c9a"),a=o("7e86");for(var i in a)["default"].indexOf(i)<0&&function(n){o.d(e,n,(function(){return a[n]}))}(i);o("ca1f");var c=o("f0c5"),r=Object(c["a"])(a["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],void 0);e["default"]=r.exports}},[["0cd5","common/runtime","common/vendor"]]]);