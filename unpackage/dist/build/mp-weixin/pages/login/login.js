(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"012b":function(n,e,o){"use strict";o.r(e);var t=o("8f82"),i=o.n(t);for(var a in t)["default"].indexOf(a)<0&&function(n){o.d(e,n,(function(){return t[n]}))}(a);e["default"]=i.a},1668:function(n,e,o){"use strict";o.d(e,"b",(function(){return t})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){}));var t=function(){var n=this.$createElement;this._self._c},i=[]},"2c35":function(n,e,o){"use strict";var t=o("c9ae"),i=o.n(t);i.a},"8f82":function(n,e,o){"use strict";(function(n,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o("b6c8"),a=o("34d1"),c={components:{WxUserInfoModal:function(){o.e("uni_modules/tuniaoui-wx-user-info/components/tuniaoui-wx-user-info/tuniaoui-wx-user-info").then(function(){return resolve(o("d4be"))}.bind(null,o)).catch(o.oe)}},data:function(){return{showAuthorizationModal:!1,userInfo:{},phone:"",hasPhone:!1,hasUserInfo:!1}},created:function(){var e=n.getStorageSync("phone");if(e){this.hasPhone=!0,this.phone=e;var o=n.getStorageSync("userInfo");o&&(this.hasUserInfo=!0,this.userInfo=o)}},methods:{openAuthorizationModal:function(){this.showAuthorizationModal=!0},updatedUserInfoEvent:function(e){this.userInfo=e,console.log(e),n.setStorageSync("userInfo",e),this.login()},getPhoneNumber:function(e){var o=this;(0,i.WeixinPhone)(e.detail.code,(function(e){0===e.code?(o.phone=e.data.phone,o.hasPhone=!0,n.setStorageSync("phone",o.phone)):n.showModal({title:"title",content:"授权失败，请重新授权",showCancel:!1})}))},login:function(){var e=this;n.login({provider:"weixin",onlyAuthorize:!0,success:function(o){"login:ok"==o.errMsg?(console.log(o),(0,i.WeixinCode)(o.code,(function(o){0===o.code?(e.openid=o.data.openid,n.setStorageSync("openid",o.data.openid),n.setStorageSync("token",o.data.salt),t.getUserInfo({success:function(o){if("getUserInfo:ok"==o.errMsg){var t=o.userInfo,i=(t.avatarUrl,t.city),c=t.country,r=t.gender,u=(t.nickName,t.province);(0,a.MemberInfoUpdate)({avatar:e.userInfo.avatar,nickname:e.userInfo.nickname,gender:r,country:c,province:u,city:i,phone:e.phone,openid:e.openid},(function(o){0===o.code?(n.setStorageSync("memberInfo",{avatar:e.userInfo.avatar,nickname:e.userInfo.nickname,gender:r,country:c,province:u,phone:e.phone,city:i}),n.navigateTo({url:"/pages/user/user"})):n.showModal({title:"title",content:"授权失败，请重新授权(1004)",showCancel:!1})}))}else n.showModal({title:"title",content:"您取消了授权登录，请重新授权(1003)",showCancel:!1})},fail:function(e){n.showModal({title:"title",content:"授权失败，请重新授权(1002)",showCancel:!1})}})):n.showModal({title:"title",content:"授权失败，请重新授权(1001)",showCancel:!1})}))):n.showModal({title:"title",content:"您取消了授权登录，请重新授权",showCancel:!1})}})}}};e.default=c}).call(this,o("543d")["default"],o("bc2e")["default"])},"9d28":function(n,e,o){"use strict";(function(n,e){var t=o("4ea4");o("1dac");t(o("66fd"));var i=t(o("ed8b"));n.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},c9ae:function(n,e,o){},ed8b:function(n,e,o){"use strict";o.r(e);var t=o("1668"),i=o("012b");for(var a in i)["default"].indexOf(a)<0&&function(n){o.d(e,n,(function(){return i[n]}))}(a);o("2c35");var c=o("f0c5"),r=Object(c["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],void 0);e["default"]=r.exports}},[["9d28","common/runtime","common/vendor"]]]);